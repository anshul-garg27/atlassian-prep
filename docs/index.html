<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlassian Interview Prep</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        slate: {
                            850: '#151f32',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        primary: {
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                        }
                    },
                    animation: {
                        'fadeIn': 'fadeIn 0.3s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Marked & Highlight.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark-dimmed.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>

    <!-- Data -->
    <script src="content_data.js"></script>

    <style>
        /* Custom Utilities */
        body {
            background-color: #020617; /* slate-950 */
            background-image: 
                radial-gradient(at 0% 0%, rgba(14, 165, 233, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(99, 102, 241, 0.15) 0px, transparent 50%);
            background-attachment: fixed;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Markdown Styles */
        .markdown-content h1 { 
            font-family: 'Outfit', sans-serif; 
            font-size: 2.5rem; 
            font-weight: 800; 
            letter-spacing: -0.025em;
            background: linear-gradient(to right, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }
        .markdown-content h2 { 
            font-family: 'Outfit', sans-serif;
            font-size: 1.75rem; 
            font-weight: 700; 
            margin-top: 2.5rem; 
            margin-bottom: 1.25rem; 
            color: #e2e8f0; 
        }
        .markdown-content h3 { 
            font-family: 'Outfit', sans-serif;
            font-size: 1.4rem; 
            font-weight: 600; 
            margin-top: 2rem; 
            margin-bottom: 1rem; 
            color: #cbd5e1; 
        }
        .markdown-content p { margin-bottom: 1.25rem; line-height: 1.8; font-size: 1.05rem; color: #cbd5e1; }
        .markdown-content ul, .markdown-content ol { margin-bottom: 1.5rem; padding-left: 1.5rem; color: #cbd5e1; }
        .markdown-content ul { list-style-type: disc; }
        .markdown-content ol { list-style-type: decimal; }
        .markdown-content li { margin-bottom: 0.5rem; }
        .markdown-content blockquote { 
            border-left: 4px solid #0ea5e9; 
            background: rgba(15, 23, 42, 0.5); 
            padding: 1rem 1.5rem; 
            border-radius: 0 0.5rem 0.5rem 0; 
            margin: 1.5rem 0; 
            color: #cbd5e1;
            font-style: italic;
        }
        .markdown-content strong { color: #f1f5f9; font-weight: 600; }
        .markdown-content :not(pre) > code { 
            background: rgba(30, 41, 59, 0.7); 
            padding: 0.2rem 0.4rem; 
            border-radius: 0.25rem; 
            color: #bfdbfe; 
            font-size: 0.9em; 
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
        }
        .markdown-content a { 
            color: #38bdf8; 
            text-decoration: none; 
            border-bottom: 1px solid transparent; 
            transition: all 0.2s; 
        }
        .markdown-content a:hover { 
            color: #7dd3fc; 
            border-bottom-color: #7dd3fc; 
        }
        
        /* Code Blocks styling */
        .code-wrapper {
            margin: 1.5rem 0;
            border-radius: 0.75rem;
            overflow: hidden;
            border: 1px solid #334155;
            background: #0f172a;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 1rem;
            background: #1e293b;
            border-bottom: 1px solid #334155;
        }
        .mac-dots { display: flex; gap: 6px; }
        .mac-dot { width: 12px; height: 12px; border-radius: 50%; }
        .mac-dot.red { background: #ef4444; }
        .mac-dot.yellow { background: #f59e0b; }
        .mac-dot.green { background: #22c55e; }
        
        .lang-badge {
            font-size: 0.75rem;
            font-weight: 600;
            color: #94a3b8;
            text-transform: uppercase;
        }
        
        .markdown-content pre {
            margin: 0;
            padding: 1.25rem;
            overflow-x: auto;
            background: transparent;
        }
        .markdown-content pre code {
            background: transparent;
            padding: 0;
            color: inherit;
            border-radius: 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        /* Table Styling */
        .markdown-content table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 1.5rem 0;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .markdown-content th, .markdown-content td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #334155;
            border-right: 1px solid #334155;
        }
        .markdown-content th:last-child, .markdown-content td:last-child {
            border-right: none;
        }
        .markdown-content tr:last-child td {
            border-bottom: none;
        }
        .markdown-content th {
            background: #1e293b;
            color: #f1f5f9;
            font-weight: 600;
            text-align: left;
        }
        .markdown-content tr:hover td {
            background: rgba(30, 41, 59, 0.5);
        }
    </style>
</head>
<body class="antialiased selection:bg-cyan-500/30 selection:text-cyan-200">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- Marked Config ---
        const renderer = new marked.Renderer();
        
        // Code block renderer
        renderer.code = function(codeBlock, language) {
            let code = codeBlock;
            let lang = language;

            if (typeof codeBlock === 'object' && codeBlock !== null) {
                code = codeBlock.text || '';
                lang = codeBlock.lang || '';
            }

            code = String(code);
            const validLang = !!(lang && hljs.getLanguage(lang));
            
            let highlighted;
            try {
                if (validLang) {
                    highlighted = hljs.highlight(code, { language: lang }).value;
                } else {
                    highlighted = hljs.highlightAuto(code).value;
                }
            } catch (e) {
                highlighted = code;
            }
            
            const displayLang = lang || 'text';

            return `
                <div class="code-wrapper group">
                    <div class="code-header">
                        <div class="mac-dots">
                            <div class="mac-dot red"></div>
                            <div class="mac-dot yellow"></div>
                            <div class="mac-dot green"></div>
                        </div>
                        <span class="lang-badge">${displayLang}</span>
                    </div>
                    <pre><code class="hljs language-${displayLang}">${highlighted}</code></pre>
                </div>
            `;
        };
        
        renderer.link = function(href, title, text) {
            let linkHref = href;
            let linkText = text;
            if (typeof href === 'object') {
                 linkHref = href.href;
                 linkText = href.text;
            }
            return `<a href="${linkHref}" target="_blank" rel="noopener noreferrer" class="text-primary-400 hover:text-primary-300 underline decoration-primary-400/30 hover:decoration-primary-300">${linkText}</a>`;
        };

        marked.setOptions({
            renderer: renderer,
            gfm: true,
            breaks: true
        });

        // --- Icons ---
        const SearchIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-slate-400"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
        );
        
        const MenuIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
        );
        
        const CloseIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        );

        const FileIcon = () => (
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="opacity-70 text-slate-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
        );

        // --- Components ---

        const Sidebar = ({ items, activeItem, onItemClick, isOpen, onClose }) => {
            const [searchTerm, setSearchTerm] = useState('');
            
            const filteredItems = useMemo(() => {
                if (!searchTerm) return items;
                const lower = searchTerm.toLowerCase();
                return items.filter(item => 
                    item.title.toLowerCase().includes(lower) || 
                    (item.content && item.content.toLowerCase().includes(lower))
                );
            }, [items, searchTerm]);

            return (
                <>
                    {/* Mobile Overlay */}
                    <div 
                        className={`fixed inset-0 bg-black/60 backdrop-blur-sm z-40 md:hidden transition-opacity duration-300 ${isOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}
                        onClick={onClose}
                    />

                    {/* Sidebar Container */}
                    <aside className={`
                        fixed md:relative z-50 w-80 h-full flex flex-col
                        bg-slate-900/95 md:bg-slate-900/50 backdrop-blur-xl
                        border-r border-slate-800/50
                        transform transition-transform duration-300 ease-[cubic-bezier(0.2,0,0,1)]
                        ${isOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'}
                    `}>
                        <div className="p-6 pb-4 flex flex-col gap-4 border-b border-slate-800/50">
                            <div className="flex justify-between items-center">
                                <div>
                                    <h1 className="font-display font-bold text-2xl bg-clip-text text-transparent bg-gradient-to-r from-sky-400 to-blue-500">
                                        Atlassian Prep
                                    </h1>
                                    <p className="text-xs text-slate-500 font-medium tracking-wider mt-1 uppercase">
                                        Data Structures Round
                                    </p>
                                </div>
                                <button onClick={onClose} className="md:hidden p-2 text-slate-400 hover:text-white">
                                    <CloseIcon />
                                </button>
                            </div>
                            
                            <div className="relative group">
                                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <SearchIcon />
                                </div>
                                <input
                                    type="text"
                                    placeholder="Search topics..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="w-full bg-slate-950/50 border border-slate-800 text-slate-200 text-sm rounded-lg focus:ring-2 focus:ring-sky-500/20 focus:border-sky-500/50 block w-full pl-10 p-2.5 transition-all placeholder:text-slate-600"
                                />
                            </div>
                        </div>

                        <div className="flex-1 overflow-y-auto py-4 px-3 space-y-1">
                            {filteredItems.length === 0 ? (
                                <div className="text-center py-8 text-slate-500 text-sm">
                                    No matches found
                                </div>
                            ) : (
                                filteredItems.map((item, idx) => {
                                    const isActive = activeItem && activeItem.path === item.path;
                                    return (
                                        <button
                                            key={item.path}
                                            onClick={() => onItemClick(item)}
                                            className={`
                                                w-full text-left px-4 py-3 rounded-lg text-sm transition-all duration-200 
                                                flex items-center gap-3 group border border-transparent
                                                ${isActive 
                                                    ? 'bg-sky-500/10 text-sky-300 border-sky-500/20 shadow-[0_0_20px_rgba(14,165,233,0.1)]' 
                                                    : 'text-slate-400 hover:bg-white/5 hover:text-slate-200 hover:border-white/5'
                                                }
                                            `}
                                        >
                                            <span className={`font-mono text-xs opacity-50 ${isActive ? 'text-sky-400' : 'group-hover:text-slate-300'}`}>
                                                {(idx + 1).toString().padStart(2, '0')}
                                            </span>
                                            <span className="font-medium truncate flex-1">
                                                {item.title}
                                            </span>
                                        </button>
                                    );
                                })
                            )}
                        </div>
                        
                        <div className="p-4 border-t border-slate-800/50 bg-black/10">
                            <a 
                                href="experiences.html" 
                                className="flex items-center justify-center gap-2 w-full px-4 py-2.5 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg text-sm font-medium transition-colors border border-slate-700"
                            >
                                <span>Read Experiences</span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                            </a>
                        </div>
                    </aside>
                </>
            );
        };

        const Content = ({ content }) => {
            const scrollRef = useRef(null);
            
            useEffect(() => {
                if (scrollRef.current) {
                    scrollRef.current.scrollTop = 0;
                }
            }, [content]);

            const htmlContent = useMemo(() => {
                if (!content) return '';
                try {
                    return marked.parse(content);
                } catch (e) {
                    return `<div class="p-4 bg-red-500/10 border border-red-500/20 text-red-400 rounded-lg">Error rendering markdown: ${e.message}</div>`;
                }
            }, [content]);

            return (
                <main className="flex-1 h-full relative overflow-hidden flex flex-col" ref={scrollRef}>
                    <div className="flex-1 overflow-y-auto scroll-smooth">
                        <div className="max-w-4xl mx-auto px-6 py-10 md:px-12 md:py-16 min-h-screen">
                            {content ? (
                                <div 
                                    className="markdown-content animate-fadeIn"
                                    dangerouslySetInnerHTML={{ __html: htmlContent }}
                                />
                            ) : (
                                <div className="flex flex-col items-center justify-center h-[60vh] text-slate-500">
                                    <div className="w-20 h-20 bg-slate-900/50 rounded-2xl flex items-center justify-center mb-6 border border-slate-800 shadow-xl">
                                        <FileIcon />
                                    </div>
                                    <h3 className="text-xl font-medium text-slate-300 mb-2">Select a Topic</h3>
                                    <p className="text-slate-500">Choose a module from the sidebar to start studying.</p>
                                </div>
                            )}
                            <div className="h-24"></div>
                        </div>
                    </div>
                </main>
            );
        };

        const App = () => {
            const [items, setItems] = useState([]);
            const [activeItem, setActiveItem] = useState(null);
            const [isSidebarOpen, setIsSidebarOpen] = useState(false);

            useEffect(() => {
                if (window.CONTENT_DATA) {
                    const dsItems = window.CONTENT_DATA
                        .find(c => c.name === "Data_Structures")
                        ?.children || [];

                    dsItems.sort((a, b) => a.name.localeCompare(b.name));

                    const processedItems = dsItems.map(item => ({
                        ...item,
                        title: item.name
                            .replace(/^\d+_/, '')
                            .replace(/\.md$/, '')
                            .replace(/_/g, ' ')
                    }));

                    setItems(processedItems);
                    if (processedItems.length > 0) {
                        setActiveItem(processedItems[0]);
                    }
                }
            }, []);

            return (
                <div className="flex h-screen overflow-hidden bg-slate-950 text-slate-200 font-sans">
                    <Sidebar 
                        items={items} 
                        activeItem={activeItem} 
                        onItemClick={(item) => {
                            setActiveItem(item);
                            setIsSidebarOpen(false);
                        }}
                        isOpen={isSidebarOpen}
                        onClose={() => setIsSidebarOpen(false)}
                    />
                    
                    <div className="flex-1 flex flex-col min-w-0 relative">
                        {/* Mobile Header */}
                        <div className="md:hidden flex items-center justify-between p-4 border-b border-slate-800 bg-slate-950/80 backdrop-blur-md z-30 sticky top-0">
                            <div className="flex items-center gap-3">
                                <button 
                                    onClick={() => setIsSidebarOpen(true)}
                                    className="p-2 -ml-2 text-slate-400 hover:text-white rounded-lg hover:bg-slate-800 transition-colors"
                                >
                                    <MenuIcon />
                                </button>
                                <span className="font-bold text-slate-100 tracking-tight">Atlassian Prep</span>
                            </div>
                        </div>

                        <Content content={activeItem?.content} />
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>